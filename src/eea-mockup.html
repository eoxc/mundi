<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
  <meta charset="UTF-8">
  <title>EEA Phenology mockup</title>
</head>
<body>
  <header id="header">
  <nav class="navbar static">
    <img src="https://ows.eox.at/common/images/pheno_logo_clms.png" alt="European Environment Agency" style="height:70px;"/>
    <h4 style="display:inline;
    color: #006699;">High Resolution Vegetation Phenology and Productivity Monitoring</h4>
  </nav>
</header>
  <div id="app" style="width: 100%; top: 70px; bottom: 0; position: absolute; margin: 0; padding:0;"></div>
  <script src="code-de.bundle.js"></script>
  <script>
  var today = new Date();
  today.setUTCHours(24, 0, 0, 0);
  var twoYearsAgo = new Date(new Date(today).setUTCFullYear(today.getUTCFullYear() - 2));
  var displayTimeDomainStart = new Date(2018, 3, 28, 0, 0, 0, 0);
  var displayTimeDomainEnd = new Date(2018, 4, 28, 0, 0, 0, 0);
  var selectedTimeDomainStart = new Date(2018, 4, 12, 2, 0, 0, 0);
  var selectedTimeDomainEnd = new Date(2018, 4, 13, 2, 0, 0, 0);

  var config = {
    "settings": {
        "tutorial": "disabled",
        "uploadEnabled": false,
        "downloadEnabled": true,
        "searchEnabled" : true,
        "searchDebounceTime": 500,
        "language": "en",
        "timeDomain": [
            "2016-01-01T00:00:00Z",
            "2018-08-01T00:00:00Z"
        ],
        "constrainTimeDomain": true,
        "displayTimeDomain": [
            displayTimeDomainStart,
            displayTimeDomainEnd,
        ],
        "displayInterval": "P730D",
        "selectedTimeDomain": [
            selectedTimeDomainStart,
            selectedTimeDomainEnd,
        ],
        "selectableInterval": "P14D",
        "timeSliderControls": true,
        "maxMapInterval": "P7D",
        "maxTooltips": 1,
        "rightPanelOpen": true,
        "leftPanelOpen": true,
        "center": [10, 50],
        "zoom": 4,
        "minZoom": 2,
        "maxZoom": 18,
        "XYZOnlyOverProducts": false,
        "footprintFillColor": "rgba(0, 0, 0, 0.2)",
        "footprintStrokeColor": "rgba(0, 0, 0, 1)",
        "filterFillColor": "rgba(0, 165, 255, 0)",
        "filterStrokeColor": "#006699",
        "filterOutsideColor": "rgba(0, 0, 0, 0.5)",
        "selectedFootprintFillColor": "rgba(204, 0, 51, 0.2)",
        "selectedFootprintStrokeColor": "#cc0033",
        "highlightFillColor": "#f9e613",
        "highlightStrokeColor": "#e3b73b",
        "highlightStrokeWidth": 3,
        "translations": {
            "de": {
                "Cloud Cover": "Wolkenbedeckung",
                "Cloud Coverage in percent": "Prozentuelle Wolkenbedeckung",
                "Production Status": "Produktionsstatus",
                "Data acquisition has been rejected for whatever reason": "Datenerfassung wurde aus welchem Grund auch immer abgelehnt",
                "Potential data acquisition": "Potentielle Datenerfassung",
                "Data acquisition planned": "Datenerfassung geplant",
                "Data acquisition failed": "Datenerfassung fehlgeschlagen",
                "Data acquisition cancelled": "Datenerfassung abgebrochen",
                "Data acquired": "Daten erfasst",
                "Data acquisition archived": "Datenerfassung archiviert",
                "Orbit Direction": "Orbitrichtung",
                "Orbit Number": "Orbitnummer",
                "Resolution": "Auflösung",
                "Platform Serial Identifier": "Plattform Identifikation",
                "Processing Level": "Prozessierungsebene",
                "Processing Version": "Prozessierungsversion",
                "Polarisation Mode": "Polarisationsmodus",
                "Polarisation Channels": "Polarisationskanäle",
                "UNDEFINED": "UNDEFINIERT",
                "Antenna Look Direction": "Antennenausrichtung",
                "Minimum Incidence Angle": "Minimaler Einfallswinkel",
                "Maximum Incidence Angle": "Maximaler Einfallswinkel",
                "LEFT": "Links",
                "RIGHT": "Rechts",
                "ASCENDING": "Aufsteigend",
                "DESCENDING": "Absteigend",
                "Single": "Einfach",
                "Double": "Doppelt",
                "Error: NoApplicableCode": "Zeitüberschreitung bei der Suche. Bitte Suchkriterien verfeinern.",
            },
            "en": {
                "Cloud Cover": "Cloud coverage (%)",
                "Error: NoApplicableCode": "Search timed out. Please refine the filter criteria.",
            }
        },
        "downloadFormats": [{
          "name": "TIFF",
          "mimeType": "image/tiff"
        }, {
          "name": "JPG",
          "mimeType": "image/jpeg",
          "maxBands": 3,
        }, {
          "name": "PNG",
          "mimeType": "image/png",
          "maxBands": 4,
        }, {
          "name": "NetCDF",
          "mimeType": "application/x-netcdf"
        }, {
          "name": "PDF",
          "mimeType": "application/pdf",
          "maxBands": 3,
        }],
        "downloadProjections": [{
          "name": "WGS-84",
          "identifier": "http://www.opengis.net/def/crs/EPSG/0/4326"
        }, {
          "name": "Google Mercator",
          "identifier": "http://www.opengis.net/def/crs/EPSG/0/3857"
        }, {
          "name": "ETRS89",
          "identifier": "http://www.opengis.net/def/crs/EPSG/0/4258"
        }],
    },
    "baseLayers": [
        {
            "id": "terrain-light",
            "displayName": "EOX Terrain-Light",
            "display": {
                "id": "terrain-light",
                "visible": false,
                "protocol": "WMTS",
                "urls": [
                    "//a.s2maps-tiles.eu/wmts/",
                    "//b.s2maps-tiles.eu/wmts/",
                    "//c.s2maps-tiles.eu/wmts/",
                    "//d.s2maps-tiles.eu/wmts/",
                    "//e.s2maps-tiles.eu/wmts/"
                ],
                "matrixSet": "WGS84",
                "format": "image/png",
                "projection": "EPSG:4326",
                "style": "default",
                "attribution": "Terrain-Light { Data &copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> contributors and <a href='javascript:;' onClick='toggle(terrain_attribution)'>others</a>, Rendering &copy; <a href=\"http://eox.at\" target=\"_blank\">EOX</a> }"
            }
        }, {
            "id": "terrain",
            "displayName": "EOX Terrain",
            "display": {
                "id": "terrain",
                "visible": false,
                "protocol": "WMTS",
                "urls": [
                    "//a.s2maps-tiles.eu/wmts/",
                    "//b.s2maps-tiles.eu/wmts/",
                    "//c.s2maps-tiles.eu/wmts/",
                    "//d.s2maps-tiles.eu/wmts/",
                    "//e.s2maps-tiles.eu/wmts/"
                ],
                "matrixSet": "WGS84",
                "format": "image/png",
                "projection": "EPSG:4326",
                "style": "default",
                "attribution": "Terrain { Data &copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> contributors and <a href='javascript:;' onClick='toggle(terrain_attribution)'>others</a>, Rendering &copy; <a href=\"http://eox.at\" target=\"_blank\">EOX</a> }"
            }
        },  {
            "id": "s2cloudless",
            "displayName": "EOX Sentinel-2 cloudless",
            "display": {
                "id": "s2cloudless",
                "visible": true,
                "protocol": "WMTS",
                "urls": [
                    "//a.s2maps-tiles.eu/wmts/",
                    "//b.s2maps-tiles.eu/wmts/",
                    "//c.s2maps-tiles.eu/wmts/",
                    "//d.s2maps-tiles.eu/wmts/",
                    "//e.s2maps-tiles.eu/wmts/"
                ],
                "matrixSet": "WGS84",
                "format": "image/png",
                "projection": "EPSG:4326",
                "style": "default",
                "attribution": "<a xmlns:dct=\"http://purl.org/dc/terms/\" href=\"https://s2maps.eu\" property=\"dct:title\">Sentinel-2 cloudless - https://s2maps.eu</a> by <a xmlns:cc=\"http://creativecommons.org/ns#\" href=\"https://eox.at\" property=\"cc:attributionName\" rel=\"cc:attributionURL\">EOX IT Services GmbH</a> (Contains modified Copernicus Sentinel data 2016 &amp; 2017)"
            }
        }
    ],
    "layers": [
      {
        "id": "geoville_pheno",
        "displayName": "Vegetation Phenology",
        "displayColor": "#96f7f4",
        "display": {
            "id": "monthly_vegetation_phenology",
            "visible": true,
            "opacity": 0.7,
            "protocol": "XYZ",
            "projection": "EPSG:3857",
            "url":"https://landmonitoring.earth/tileserver/YYYYMM_Pheno_S2_20m_1_13/{z}/{x}/{y}.png",
            "timeRecords":[ 
            ['2016-01-01T00:00:00Z','2016-01-31T23:59:59Z'],
            ['2016-02-01T00:00:00Z','2016-02-29T23:59:59Z'],
            ['2016-03-01T00:00:00Z','2016-03-31T23:59:59Z'],
            ['2016-04-01T00:00:00Z','2016-04-30T23:59:59Z'],
            ['2016-05-01T00:00:00Z','2016-05-31T23:59:59Z'],
            ['2016-06-01T00:00:00Z','2016-06-30T23:59:59Z'],
            ['2016-07-01T00:00:00Z','2016-07-31T23:59:59Z'],
            ['2016-08-01T00:00:00Z','2016-08-31T23:59:59Z'],
            ['2016-09-01T00:00:00Z','2016-09-30T23:59:59Z'],
            ['2016-10-01T00:00:00Z','2016-10-31T23:59:59Z'],
            ['2016-11-01T00:00:00Z','2016-11-30T23:59:59Z'],
            ['2016-12-01T00:00:00Z','2016-12-31T23:59:59Z'],
            ['2017-01-01T00:00:00Z','2017-01-31T23:59:59Z'],
            ['2017-02-01T00:00:00Z','2017-02-28T23:59:59Z'],
            ['2017-03-01T00:00:00Z','2017-03-31T23:59:59Z'],
            ['2017-04-01T00:00:00Z','2017-04-30T23:59:59Z'],
            ['2017-05-01T00:00:00Z','2017-05-31T23:59:59Z'],
            ['2017-06-01T00:00:00Z','2017-06-30T23:59:59Z'],
            ['2017-07-01T00:00:00Z','2017-07-31T23:59:59Z'],
            ['2017-08-01T00:00:00Z','2017-08-31T23:59:59Z'],
            ['2017-09-01T00:00:00Z','2017-09-30T23:59:59Z'],
            ['2017-10-01T00:00:00Z','2017-10-31T23:59:59Z'],
            ['2017-11-01T00:00:00Z','2017-11-30T23:59:59Z'],
            ['2017-12-01T00:00:00Z','2017-12-31T23:59:59Z'],
            ['2018-01-01T00:00:00Z','2018-01-31T23:59:59Z'],
            ['2018-02-01T00:00:00Z','2018-02-28T23:59:59Z'],
            ['2018-03-01T00:00:00Z','2018-03-31T23:59:59Z'],
            ['2018-04-01T00:00:00Z','2018-04-30T23:59:59Z'],
            ['2018-05-01T00:00:00Z','2018-05-31T23:59:59Z'],
            ['2018-06-01T00:00:00Z','2018-06-30T23:59:59Z'],
            ['2018-07-01T00:00:00Z','2018-07-31T23:59:59Z'],
          ],
            "attribution": "Overlay { Data &copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> contributors, Rendering &copy; <a href=\"http://eox.at\" target=\"_blank\">EOX</a> and <a href=\"https://github.com/mapserver/basemaps\" target=\"_blank\">MapServer</a>, S-2 Phenology contains Copernicus data (2015-2018), processed by<a href=\"https://www.geoville.com/\" target=\"_blank\">GeoVille &copy</a> }",
            "legendUrl": "https://ows.eox.at/common/images/pheno_legend_mockup.png",
        },
      }, {
            "id": "S2_MSI_L2A",
            "displayName": "Sentinel-2 MSI - Level 2A (Bottom-of-Atmosphere Reflectance)",
            "displayColor": "#ffcd5a",
            "display": {
                "id": "S2-L2A",
                "visible": true,
                "opacity": 0,
                "protocol": "WMTS",
                "matrixSet": "WGS84",
                "format": "image/png",
                "projection": "EPSG:4326",
                "urls": [
                    "//a.s2-l2a.tiles.mundi.eox.at/c/wmts/",
                    "//b.s2-l2a.tiles.mundi.eox.at/c/wmts/",
                    "//c.s2-l2a.tiles.mundi.eox.at/c/wmts/",
                    "//d.s2-l2a.tiles.mundi.eox.at/c/wmts/",
                    "//e.s2-l2a.tiles.mundi.eox.at/c/wmts/",
                    "//f.s2-l2a.tiles.mundi.eox.at/c/wmts/",
                    "//g.s2-l2a.tiles.mundi.eox.at/c/wmts/",
                    "//h.s2-l2a.tiles.mundi.eox.at/c/wmts/",
                ],
                "useMilliseconds": false,
                "maxZoom": 18,
            }, 
            // full resolution and processing taken from CODE-DE L1C
            "processing": {
                "url": "https://processing.code-de.org/injectInputSelection",
                "method": "form"
            },
            "fullResolution": {
                "protocol": "WCS",
                "id": "Sentinel2__S2_MSI_L1C_FULL",
                "url": "https://geoservice.code-de.org/Sentinel2/wcs?sortBy=time%20D&",
                "cqlParameterName": "cql_filter",
                "cqlMapping": {
                    "eo:cloudCover": "cloudcover",
                },
                "maxSizeWarning": 500,
                "maxSizeResolution": 0.0000858306884765625,
                "axisNames": [
                    'http://www.opengis.net/def/axis/OGC/0/Long',
                    'http://www.opengis.net/def/axis/OGC/0/Lat'
                ],
                "fields": [{
                  "name": "B01",
                  "identifier": "B01"
                }, {
                  "name": "B02",
                  "identifier": "B02"
                }, {
                  "name": "B03",
                  "identifier": "B03"
                }, {
                  "name": "B04",
                  "identifier": "B04"
                }, {
                  "name": "B05",
                  "identifier": "B05"
                }, {
                  "name": "B06",
                  "identifier": "B06"
                }, {
                  "name": "B07",
                  "identifier": "B07"
                }, {
                  "name": "B08",
                  "identifier": "B08"
                }, {
                  "name": "B09",
                  "identifier": "B09"
                }, {
                  "name": "B10",
                  "identifier": "B10"
                }, {
                  "name": "B11",
                  "identifier": "B11"
                }, {
                  "name": "B12",
                  "identifier": "B12"
                }, {
                  "name": "B8A",
                  "identifier": "B8A"
                }],
                "interpolations": [{
                  "name": "Nearest-Neighbor",
                  "identifier": "http://www.opengis.net/def/interpolation/OGC/1/nearest-neighbor"
                }, {
                  "name": "Linear",
                  "identifier": "http://www.opengis.net/def/interpolation/OGC/1/linear"
                }, {
                  "name": "Cubic",
                  "identifier": "http://www.opengis.net/def/interpolation/OGC/1/cubic"
                }]
            },
            "search": {
                "protocol": "OpenSearch",
                "url": "S2_MSI_L2A.osdd",
                "id": "DIAS_CWS:S2_MSI_L2A",
                "histogramBinCount": 28,
                "format": "application/atom+xml",
                "method": "GET",
                "histogramThreshold": 600,
                "lightweightBuckets": true,
                "searchLimit": 800,
                "loadMore":400,
                "parameters": [
                    {
                        "type": "eo:cloudCover",
                        "max": 100,
                        "min": 0,
                        "range": true,
                        "title": "Cloud Coverage in percent"
                    },
                    {
                        "type": "DIAS:onlineStatus",
                        "default": "ONLINE",
                    },
                    {
                        "type": "DIAS:productDeliveryFormat",
                        "fixed": "folder",
                    }
                ],
                "extraFields": {
                    "properties.mundi.date": "dc:date/text()",
                    "properties.mundi.processingDate": "eo:processingDate/text()",
                    "properties.mundi.published": "atom:published/text()",
                    "properties.mundi.updated": "atom:updated/text()",

                    "properties.mundi.platform": "eo:platform/text()",
                    "properties.mundi.instrument": "eo:instrument/text()",
                    "properties.mundi.processingLevel": "eo:processingLevel/text()",

                    "properties.mundi.cloudCover": "eo:cloudCover/text()",

                    "properties.mundi.radiometricQuality": "DIAS:radiometricQuality/text()",
                    "properties.mundi.formatCorrectness": "DIAS:formatCorrectness/text()",

                    "properties.mundi.onlineStatus": "DIAS:onlineStatus/text()",
                    "properties.mundi.productDeliveryFormat": "DIAS:productDeliveryFormat/text()",
                    "properties.mundi.productDatapackSize": "DIAS:productDatapackSize/text()",
                    "properties.mundi.datatakeId": "DIAS:datatakeId/text()",
                    "properties.mundi.enclosure": "atom:link[@rel='search']/@href",
                    "properties.mundi.enclosure": "atom:link[@rel='enclosure']/@href",
                    "properties.mundi.externalUrl": "DIAS:externalUrls/text()",
                    "properties.mundi.format": "dc:format/text()",
                },
                "extraFieldsNamespaces": {
                    "DIAS": "http://tas/DIAS",
                    "eo": "http://a9.com/-/spec/opensearch/extensions/eo/1.0/",
                    "dc": "http://purl.org/dc/elements/1.1/",
                    "atom": "http://www.w3.org/2005/Atom"
                },
                "descriptionTemplate":
                    "<table class='table table-condensed'>" +
                    "<tr>" +
                      "<td>Sensing Start Date</td>" +
                      "<td>{{properties.mundi.date}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Processing Date</td>" +
                      "<td>{{properties.mundi.processingDate}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Publishing Date</td>" +
                      "<td>{{properties.mundi.published}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Updating Date</td>" +
                      "<td>{{properties.mundi.updated}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Platform</td>" +
                      "<td>{{properties.mundi.platform}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Instrument</td>" +
                      "<td>{{properties.mundi.instrument}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Processing Level</td>" +
                      "<td>{{properties.mundi.processingLevel}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Cloud Cover</td>" +
                      "<td>{{properties.mundi.cloudCover}}&#37;</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Radiometric Quality</td>" +
                      "<td>{{properties.mundi.radiometricQuality}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Format Correctness</td>" +
                      "<td>{{properties.mundi.formatCorrectness}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Online Status</td>" +
                      "<td>{{properties.mundi.onlineStatus}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Product Datapack Size</td>" +
                      "<td>{{properties.mundi.productDatapackSize}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Datatake ID</td>" +
                      "<td>{{properties.mundi.datatakeId}}</td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>External URL</td>" +
                      "<td><a href=\"{{properties.mundi.externalUrl}}\" target=\"_blank\">{{properties.mundi.externalUrl}}</a></td>" +
                    "</tr>" +
                    "<tr>" +
                      "<td>Format</td>" +
                      "<td>{{properties.mundi.format}}</td>" +
                    "</tr>" +
                    "</table>",
            },
            "download": {
                "protocol": "S3",
                "rewrite": {
                    "from": "^https:\/\/obs\.eu-de\.otc\.t-systems\.com\/",
                    "to": "https://mundiwebservices.com/",
                },
                "pathPrefix": "dp/"
            },
        }
    ],
    "overlayLayers": [
        {
            "id": "overlay_base",
            "displayName": "EOX Borders and Labels",
            "display": {
                "id": "overlay_base",
                "visible": true,
                "protocol": "WMTS",
                "urls": [
                    "//a.tiles.maps.eox.at/wmts/",
                    "//b.tiles.maps.eox.at/wmts/",
                    "//c.tiles.maps.eox.at/wmts/",
                    "//d.tiles.maps.eox.at/wmts/",
                    "//e.tiles.maps.eox.at/wmts/"
                ],
                "matrixSet": "WGS84",
                "style": "default",
                "format": "image/png",
                "projection": "EPSG:4326",
                "attribution": "Overlay { Data &copy; <a href=\"http://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> contributors, Rendering &copy; <a href=\"http://eox.at\" target=\"_blank\">EOX</a> and <a href=\"https://github.com/mapserver/basemaps\" target=\"_blank\">MapServer</a> }"
            }
        },
    ]
};

    var app = new Application({
      config: config,
      container: document.getElementById('app'),
    });
    app.start();
  </script>
</body>
</html>
